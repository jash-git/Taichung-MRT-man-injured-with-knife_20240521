!function(){"use strict";var e=window.rapidPageConfig,t=window.YAHOO,n=window.wafer,a=t.context,o=a.meta,i=void 0===o?{}:o;a.site,i.siteAttribute,i.url,n.utils.getUrlParameterValueByName;var r=(e||{}).rapidConfig;r&&r.keys,t.i13n&&t.i13n.SPACEID,function(e){var t=e.rapidInstance,n=e.rapidPageConfig,a=e.wafer,o=e.YAHOO,i=1e3,r=-150,c=function(e){return e*e*e},s=o.context,d=s.device,m=void 0===d?"desktop":d,l=s.feature,u=void 0===l?"":l,v=s.lang,f=s.meta,p=void 0===f?{}:f,g=s.region,y=s.site,h={},w="smartphone"===m,C=function(e){var t={},n=function(n){if(e.hasOwnProperty(n)){var a=e[n];Array.isArray(a)?(t[n]=[],a.forEach((function(e){t[n].push(e)}))):"function"==typeof a||(Object(a)===a?t[n]=Object.assign({},a):t[n]=a)}};for(var a in e)n(a);return t}(n.rapidConfig),b=C.keys;b.p_cpos="",b.pct="comments";var _=p.uuid;!function(n){var s,d,l,f=n.commentsAllowed,x=n.uuid;if(!f||!x)return console.error("[comments] comments not allowed on this page, uuid missing or not needed due to SpotIm testing"),null;var O=p.xhrPathPrefix,A=void 0===O?"/nel_ms/_td/remote":O,S=n.messageId,I=n.publisher,M=n.replyId,k=n.title,P=n.type,E=n.contentType,T=n.url,U=w?"community-bar":"community-bar-"+x,D=!w&&-1!==u.indexOf("disableCommentsMessage"),j=-1!==u.indexOf("canvasCmts"),q=-1!==u.indexOf("enableShareUrlToShortenUrl");if(!h[x]){var B=n.spaceId||o.i13n&&o.i13n.SPACEID;_=x,b.pstaid_p=_,b.pstaid=_,P&&(b.pt=P),I&&(b.pcp=I);try{var F=0;if(document&&document.location.search.indexOf("bcmt")>=1&&(F=1),-1!==u.indexOf("disableCommentsMessage")&&(F=0),h[x]=!0,D&&a){var H=document.getElementById(U),N=A.replace("rcv","td");N+="?m_mode=json&m_id=tdv2-applet-canvass.message&ctrl=CanvassMessage",N+="&context=".concat(x,"&device=").concat(m,"&site=").concat(y,"&region=").concat(g,"&lang=").concat(v);var Y=JSON.stringify({config:{contextUrl:T,contextUuid:_,enableShareUrlToShortenUrl:q,ui:{enableFeedback:!1}},ctrl:"CanvassMessage",m_id:"tdv2-applet-canvass.message",m_mode:"json"}),L='<div class="wafer-fetch'.concat(q?" share-button-shortened-url":"",'" ')+'data-wf-trigger="onLoad" data-wf-cache-strategy="cacheFirst" data-wf-replace="1" '+"data-wf-body=".concat(Y," ")+"data-wf-url=".concat(N,"></div>");return H.innerHTML=L,void a.base.sync(H)}if(!o.CanvassComments)return void console.error("[comments] Missing required window.YAHOO.CanvassComments object");var R=w&&"article_20";w?-1!==u.indexOf("enableDarkMode")&&(R="article_20_dark"):q&&(R="article_20_shorten_url"),j&&(R="canvasCmt");var J={apptype:"default",bucket:C.test_id||"",context:x||"",contextDisplayText:k.replace(/'/g,"%27")||"",contextUrl:T||"",device:m,expanded:F,lang:v,namespace:"preview"===E?"yahoo_offnet":"yahoo_content",prid:b._rid||"",rapid:t,rapidKeys:b,region:g,site:y,spaceid:B,theme:"redesign",themeContainerClasses:"Ff(YahooSans)",trafficSource:R,useRelativeHostName:1};S&&(J.messageId=S,M&&(J.replyId=M)),e.CAAS_COMMENTS=new o.CanvassComments(U,J);for(var K=w?document.querySelectorAll('[id^="module-view-comments"]'):document.getElementsByClassName("caas-comment"),V=function(n){var a="";w&&n>0&&(a=null===(d=null===(s=K[n])||void 0===s?void 0:s.querySelector('[data-type="commentsCount"]'))||void 0===d?void 0:d.getAttribute("data-id")),null===(l=K[n])||void 0===l||l.addEventListener("click",(function(n){return function(n,a){void 0===a&&(a="");n.preventDefault(),n.stopPropagation();var o=w?""!==a?"community-bar-".concat(a,"-iframe"):"community-bar-iframe":"community-bar-".concat(_,"-iframe"),s=document.getElementById(o),d=function(t,n,a,o,i){var r=n-t,s=r/a;s=Math.min(s,1);var m=c(s);e.scroll(0,i+o*m),r<a&&requestAnimationFrame((function(e){var n=e||(new Date).getTime();d(t,n,a,o,i)}))};t&&t.beaconClick("cmmts","Reaction",0,{elm:"cmmt_open",g:_,itc:0},null);var m=s&&s.contentWindow;m&&(m.postMessage("canvass:expand","*"),w||requestAnimationFrame((function(t){var n=t||(new Date).getTime(),a=i,o=n,c=e.pageYOffset,m=s.getBoundingClientRect().top+r;d(o,n,a,m,c)})))}(n,a)}))},W=0;W<K.length;W++)V(W)}catch(e){}}}(p)}(window)}();
//# sourceMappingURL=comments.js.map
